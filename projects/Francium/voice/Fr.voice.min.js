/**
.---------------------------------------------------------------------------.
| The Francium Project                                                      |
| ------------------------------------------------------------------------- |
| This software "voice" is a part of the Francium (Fr) project.             |
| http://subinsb.com/the-francium-project                                   |
| ------------------------------------------------------------------------- |
|    Author: Subin Siby                                                     |
| Copyright (c) 2014 - 2015, Subin Siby. All Rights Reserved.               |
| ------------------------------------------------------------------------- |
|   License: Distributed under the Apache License, Version 2.0              |
|            http://www.apache.org/licenses/LICENSE-2.0                     |
| This program is distributed in the hope that it will be useful - WITHOUT  |
| ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or     |
| FITNESS FOR A PARTICULAR PURPOSE.                                         |
'---------------------------------------------------------------------------'
*/

/**
.---------------------------------------------------------------------------.
|  Software:      Francium Voice                                            |
|  Version:       0.5.1 (Last Updated on 2016 December 08)                  |
|  Documentation: http://subinsb.com/html5-record-mic-voice                 |
|  Contribute:    https://github.com/subins2000/Francium-voice              |
'---------------------------------------------------------------------------'
*/
!function(a){a.Fr=a.Fr||{},Fr.voice={mp3WorkerPath:"src/mp3Worker.js",stream:!1,input:!1,init_called:!1,stopRecordingTimeout:!1,init:function(){try{a.AudioContext=a.AudioContext||a.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,a.URL=a.URL||a.webkitURL,navigator.getUserMedia===!1&&alert("getUserMedia() is not supported in your browser"),this.context=new AudioContext}catch(a){alert("Web Audio API is not supported in this browser")}},record:function(a,b,c){var b=b||function(){},c=c||function(){};this.init_called===!1&&(this.init(),this.init_called=!0);var d=this;navigator.getUserMedia({audio:!0},function(e){d.input=d.context.createMediaStreamSource(e),a===!0&&d.input.connect(d.context.destination),d.recorder=new Recorder(d.input,{mp3WorkerPath:d.mp3WorkerPath,recordingCallback:c}),d.stream=e,d.recorder.record(),b(e)},function(){alert("No live audio input")})},pause:function(){this.recorder.stop()},resume:function(){this.recorder.record()},stop:function(){return this.recorder.stop(),this.recorder.clear(),this.stream.getTracks().forEach(function(a){a.stop()}),this},export:function(b,c){"mp3"==c?this.recorder.exportMP3(b):this.recorder.exportWAV(function(d){if(""==c||"blob"==c)b(d);else if("base64"==c){var e=new a.FileReader;e.readAsDataURL(d),e.onloadend=function(){base64data=e.result,b(base64data)}}else if("URL"==c){var f=URL.createObjectURL(d);b(f)}})},stopRecordingAfter:function(a,b){var b=b||function(){};clearTimeout(this.stopRecordingTimeout),this.stopRecordingTimeout=setTimeout(function(){Fr.voice.pause(),b()},a)}}}(window);