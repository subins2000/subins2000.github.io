/**
.---------------------------------------------------------------------------.
| The Francium Project                                                      |
| ------------------------------------------------------------------------- |
| This software "voice" is a part of the Francium (Fr) project.             |
| http://subinsb.com/the-francium-project                                   |
| ------------------------------------------------------------------------- |
|    Author: Subin Siby                                                     |
| Copyright (c) 2014 - 2015, Subin Siby. All Rights Reserved.               |
| ------------------------------------------------------------------------- |
|   License: Distributed under the Apache License, Version 2.0              |
|            http://www.apache.org/licenses/LICENSE-2.0                     |
| This program is distributed in the hope that it will be useful - WITHOUT  |
| ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or     |
| FITNESS FOR A PARTICULAR PURPOSE.                                         |
'---------------------------------------------------------------------------'
*/

/**
.---------------------------------------------------------------------------.
|  Software:      Francium Voice                                            |
|  Version:       0.5 (Last Updated on 2016 July 16)                        |
|  Documentation: http://subinsb.com/html5-record-mic-voice                 |
|  Contribute:    https://github.com/subins2000/Francium-voice              |
'---------------------------------------------------------------------------'
*/
!function(e){e.Fr=e.Fr||{},Fr.voice={mp3WorkerPath:"src/mp3Worker.js",stream:!1,input:!1,init_called:!1,init:function(){try{e.AudioContext=e.AudioContext||e.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,e.URL=e.URL||e.webkitURL,navigator.getUserMedia===!1&&alert("getUserMedia() is not supported in your browser"),this.context=new AudioContext}catch(t){alert("Web Audio API is not supported in this browser")}},record:function(e,t,r){var t=t||function(){},r=r||function(){};this.init_called===!1&&(this.init(),this.init_called=!0);var i=this;navigator.getUserMedia({audio:!0},function(o){i.input=i.context.createMediaStreamSource(o),e===!0&&i.input.connect(i.context.destination),i.recorder=new Recorder(i.input,{mp3WorkerPath:i.mp3WorkerPath,recordingCallback:r}),i.stream=o,i.recorder.record(),t(o)},function(){alert("No live audio input")})},pause:function(){this.recorder.stop()},resume:function(){this.recorder.record()},stop:function(){return this.recorder.stop(),this.recorder.clear(),this.stream.getTracks().forEach(function(e){e.stop()}),this},"export":function(t,r){"mp3"==r?this.recorder.exportMP3(t):this.recorder.exportWAV(function(i){if(""==r||"blob"==r)t(i);else if("base64"==r){var o=new e.FileReader;o.readAsDataURL(i),o.onloadend=function(){base64data=o.result,t(base64data)}}else if("URL"==r){var n=URL.createObjectURL(i);t(n)}})}}}(window);
